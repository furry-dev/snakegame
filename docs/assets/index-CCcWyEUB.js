var g=Object.defineProperty;var f=(i,e,t)=>e in i?g(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var r=(i,e,t)=>(f(i,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();class p{static show(e){e.innerHTML=`
            <div class="start-header">
                <h3>My record:</h3>
                <a class="score">${localStorage.getItem("record")||0}</a>
            </div>
            <h1>Snake</h1>
            <div class="buttons">
                <button class="start">Start</button>
            </div>
        `}}class v{constructor(e){r(this,"_board");this._board=e,this._board.innerHTML="",this.drawCells()}drawCells(){let e=10,t=0,o=1;for(let s=0;s<100;s++){s%10===0&&s!==0?(e++,t=1,o++):t++;const n=s<10?s:e;this._board.innerHTML+=`<div class="cell" style="animation-delay: ${n/10}s" data-x="${t}" data-y="${o}"></div>`}}placeSnake(e){e.coords.forEach(t=>{var o;(o=this.getCell(t.x,t.y))==null||o.classList.add("snake")})}removeSnake(){this._board.querySelectorAll(".cell.snake").forEach(e=>e.classList.remove("snake"))}placeFood(e){this.removeFood();const t=this.getCell(e.coords.x,e.coords.y);return t?(t.style.background=`url("${e.view}") center / contain no-repeat`,t.classList.add("food"),!0):!1}removeFood(){this._board.querySelectorAll(".cell.food").forEach(e=>{if(!(e instanceof HTMLElement))return!1;e.classList.remove("food"),e.style.removeProperty("background")})}moveSnake(e){this.removeSnake(),this.placeSnake(e)}clearBoard(){this.removeFood(),this.removeSnake()}getCell(e,t){return this._board.querySelector(`.cell[data-x="${e}"][data-y="${t}"]`)}}class l extends HTMLDivElement{constructor(){super();r(this,"_score",0);this.score=0,this.style.fontSize="2em",this.style.textAlign="center"}set score(t){this._score=t,this.innerHTML=`Score: ${this._score}`}get score(){return this._score}}customElements.define("score-counter-element",l,{extends:"div"});class m extends HTMLDivElement{constructor(){super();r(this,"seconds");r(this,"intervalId");this.seconds=0,this.innerHTML="0:00",this.style.fontSize="2em",this.style.textAlign="center"}start(){this.intervalId=setInterval(()=>{this.seconds++,this.updateTime()},1e3)}stop(){clearInterval(this.intervalId)}restart(){this.seconds=0,this.start()}get time(){const t=Math.floor(this.seconds/60),o=this.seconds%60;return`${t}:${o<10?"0":""}${o}`}updateTime(){this.innerHTML=this.time}}customElements.define("stopwatch-element",m,{extends:"div"});class w{constructor(e){r(this,"_container");r(this,"_score");r(this,"_board");r(this,"_timer");r(this,"header");r(this,"_boardContainer");this._container=e,this.header=document.createElement("div"),this.header.classList.add("game-header"),this._timer=new m,this.header.appendChild(this._timer),this._score=new l,this.header.appendChild(this._score),this._boardContainer=document.createElement("div"),this._boardContainer.classList.add("board"),this._board=new v(this._boardContainer)}show(){this._container.innerHTML="",this._container.append(this.header),this._container.append(this._boardContainer)}set score(e){this._score.score=e}get score(){return this._score.score}}class h{static show(e,t,o){const s=document.createElement("div");s.classList.add("end-game"),s.innerHTML=`
            <h3>End of the game!</h3>
            ${t>parseInt(localStorage.getItem("old-record")||"0")?"<h4 class='new-record'>New record!</h4>":""}
            <div class="data">
                <div class="score">${t}</div>
                <div class="time">${o}</div>
            </div>
            <div class="buttons">
                <button type="reset">Restart</button>
            </div>
        `,e.append(s)}static hide(e){var t;(t=e.querySelector(".end-game"))==null||t.remove()}}const _="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20x='0px'%20y='0px'%20viewBox='0%200%20106.06%20122.88'%20style='enable-background:new%200%200%20106.06%20122.88'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e.st0{fill-rule:evenodd;clip-rule:evenodd;fill:%23D3141B;}%20.st1{fill-rule:evenodd;clip-rule:evenodd;fill:%237DB820;}%20.st2{fill-rule:evenodd;clip-rule:evenodd;fill:%23537918;}%20.st3{fill-rule:evenodd;clip-rule:evenodd;fill:%23543429;}%20.st4{fill-rule:evenodd;clip-rule:evenodd;fill:%23FFFFFF;}%3c/style%3e%3cg%3e%3cpath%20class='st0'%20d='M41.57,31.85C7.85,21.26-10.8,60.03,6.67,90.74c5.23,9.19,11.57,18.65,21.4,27.25%20c9.35,6.7,17.58,5.78,25.19,1.63c6.05,2.87,12.45,4.01,19.33,1.43c10.11-3.8,20.41-18.8,25.26-28.07%20c10.6-20.27,14.2-46.28-9.44-58.96c-6.45-3.46-14.52-4.47-24.74-2.18C56.87,34.18,48.42,33.94,41.57,31.85L41.57,31.85z'/%3e%3cpath%20class='st1'%20d='M33.99,28.12c5.16,0.64,10.71-0.55,16.69-3.75l1.14-5.83C45.3,7.04,34.29,1.09,16.17,3.86L9.05,4.61%20C14.26,15.44,20.69,26.49,33.99,28.12L33.99,28.12L33.99,28.12z'/%3e%3cpath%20class='st2'%20d='M17.3,8.52c11.85,4.1,19.55,5.74,29.5,13.44C35.06,18.1,27.61,15.57,17.3,8.52L17.3,8.52z'/%3e%3cpath%20class='st3'%20d='M50.08,25.82l0.07-0.04c-0.34,2.54-0.49,4.89-0.46,7.69L56,33.6c-0.07-5.33,0.62-9.87,1.99-14.06%20c1.83-5.58,4.92-10.23,9.07-14.07c1.28-1.18,1.36-3.17,0.19-4.45c-1.18-1.28-3.17-1.36-4.45-0.19c-4.95,4.57-8.61,10.1-10.8,16.76%20c-0.28,0.86-0.55,1.75-0.78,2.65l-0.04-0.07L50.08,25.82L50.08,25.82z'/%3e%3cpath%20class='st4'%20d='M16.87,78.58c1.25-0.42,2.61,0.25,3.03,1.51c1.35,4.04,3.37,7.67,5.88,10.98c2.56,3.35,5.63,6.38,9.07,9.18%20c1.02,0.83,1.18,2.34,0.35,3.37c-0.83,1.02-2.34,1.18-3.37,0.35c-3.73-3.03-7.06-6.33-9.85-9.99c-2.83-3.71-5.09-7.79-6.62-12.36%20C14.95,80.36,15.62,79.01,16.87,78.58L16.87,78.58L16.87,78.58z'/%3e%3c/g%3e%3c/svg%3e";class y{constructor(e){r(this,"power",1);r(this,"view",_);r(this,"coords");this.coords=e}}class a{constructor(e,t){this.x=e,this.y=t}isEqual(e){return this.x===e.x&&this.y===e.y}}class u extends Array{constructor(...e){super(...e)}hasCoords(e){return this.some(t=>t.isEqual(e))}}class S{constructor(){r(this,"_direction","right");r(this,"coords",new u(new a(1,1)));r(this,"_growth",0)}growth(e){this._growth=e}get length(){return this.coords.length}setDirection(e){switch(e){case"right":if(this._direction==="left"&&this.length>1)return!1;break;case"left":if(this._direction==="right"&&this.length>1)return!1;break;case"top":if(this._direction==="down"&&this.length>1)return!1;break;case"down":if(this._direction==="top"&&this.length>1)return!1;break}this._direction=e}get direction(){return this._direction}move(){let e;switch(this._direction){case"right":e=new a(this.head.x+1,this.head.y);break;case"left":e=new a(this.head.x-1,this.head.y);break;case"top":e=new a(this.head.x,this.head.y-1);break;case"down":e=new a(this.head.x,this.head.y+1);break}return e.x<1||e.x>10||e.y<1||e.y>10||this.coords.hasCoords(e)?!1:(this.coords.unshift(e),this.length>1&&this._growth<1?this.coords.pop():this._growth--,!0)}get head(){return this.coords[0]}get tail(){return this.coords[this.coords.length-1]}}function c(i,e){return Math.floor(Math.random()*(e-i+1)+i)}class b{constructor(e){r(this,"container");r(this,"snake");r(this,"food");r(this,"gameLoop");r(this,"speed",500);r(this,"gameScreen");this.container=e,this.snake=new S,p.show(this.container),this.gameScreen=new w(this.container),this.setEventListeners()}setEventListeners(){this.container.addEventListener("click",e=>{const t=e.target;if(!(t instanceof HTMLElement))return!1;t.closest(".start")&&(this.gameScreen.show(),this.startGame()),t.closest('button[type="reset"]')&&this.restartGame()}),document.addEventListener("keydown",e=>{switch(e.key){case"ArrowUp":this.snake.setDirection("top");break;case"ArrowRight":this.snake.setDirection("right");break;case"ArrowDown":this.snake.setDirection("down");break;case"ArrowLeft":this.snake.setDirection("left");break}})}placeFood(){if(this.snake.length>99)return!1;let e=new a(c(1,10),c(1,10));for(;this.snake.coords.hasCoords(e);)e=new a(c(1,10),c(1,10));return this.food=new y(e),this.gameScreen._board.placeFood(this.food)}startGame(){localStorage.setItem("old-record",localStorage.getItem("record")||"0"),this.gameScreen._board.placeSnake(this.snake),this.placeFood(),this.gameScreen.score=this.snake.length,this.gameLoop=setInterval(this.render.bind(this),this.speed),this.gameScreen._timer.restart()}stopGame(){clearInterval(this.gameLoop),this.gameScreen._timer.stop()}restartGame(){this.gameScreen._board.clearBoard(),h.hide(this.container),this.snake.coords=new u(new a(1,1)),this.snake.setDirection("right"),this.startGame()}render(){if(this.snake.move()||(h.show(this.container,this.gameScreen.score,this.gameScreen._timer.time),this.stopGame()),this.food&&this.snake.head.isEqual(this.food.coords)){if(this.snake.growth(this.food.power),this.gameScreen.score+=this.food.power,this.gameScreen.score>parseInt(localStorage.getItem("record")||"0")&&localStorage.setItem("record",String(this.gameScreen.score)),this.snake.length>99)return h.show(this.container,this.gameScreen.score,this.gameScreen._timer.time);this.placeFood()}requestAnimationFrame(()=>this.gameScreen._board.moveSnake(this.snake))}}new b(document.querySelector("#app"));
